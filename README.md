# WinterPractik ‚Äî –ú–µ–Ω–µ–¥–∂–µ—Ä —Ñ–∞–π–ª–æ–≤ 

REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ —Ñ–∞–π–ª–æ–≤ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. 
–í—Å–µ –æ—Ç–≤–µ—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON. –†–∞–±–æ—Ç–∞–µ—Ç —Å PostgreSQL –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQLAlchemy ORM.

## üê≥ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å Docker

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

```bash
docker-compose up -d
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:5000`  
PostgreSQL: `localhost:5432`

–û—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
docker-compose down
```

–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:
```bash
docker-compose logs -f app
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **`main.py`** ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å RESTful —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏.
- **`backend/config.py`** ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.
- **`backend/db.py`** ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è SQLAlchemy engine –∏ session.
- **`backend/models.py`** ‚Äî ORM –º–æ–¥–µ–ª—å `File` –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã –ë–î.
- **`backend/schemas.py`** ‚Äî `FileUpdate` –º–æ–¥–µ–ª—å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ JSON –≤ –æ–±—ä–µ–∫—Ç—ã.
- **`backend/manager.py`** ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (`FileManager`): CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞–º–∏ –∏ –ë–î —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è (Windows PowerShell)

```powershell
python -m venv .venv
.\.venv\Scripts\Activate.ps1
pip install -r requirements.txt
```

### 2. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–∂–∏–¥–∞–µ—Ç:
```
postgresql+psycopg2://postgres:kirill@localhost:5432/WinterPractic
```

### 3. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```powershell
python main.py
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: `http://127.0.0.1:5000`

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `backend/config.py`. –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|---|---|
| `DATABASE_URL` | `postgresql+psycopg2://postgres:kirill@localhost:5432/WinterPractic` | –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL |
| `STORAGE_PATH` | –¢–µ–∫—É—â–∞—è –ø–∞–ø–∫–∞ | –ü—É—Ç—å –∫ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ |
| `DEBUG` | `True` | –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ Flask |

–ü—Ä–∏–º–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ PowerShell:
```powershell
$Env:DATABASE_URL = "postgresql+psycopg2://user:pass@host:5432/dbname"
$Env:STORAGE_PATH = "C:/MyStorage"
```

## REST API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

–í—Å–µ –æ—Ç–≤–µ—Ç—ã ‚Äî JSON. –ö–æ–¥—ã –æ—à–∏–±–æ–∫: 400 (–Ω–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ), 404 (–Ω–µ –Ω–∞–π–¥–µ–Ω–æ), 500 (–æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞).

### GET `/`
–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
```bash
curl http://127.0.0.1:5000/
```
–û—Ç–≤–µ—Ç:
```json
{"status": "ok"}
```

### GET `/files`
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤. –ú–æ–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–µ –≤ –ø—É—Ç–∏: `?q=substring`.
```bash
curl http://127.0.0.1:5000/files
curl http://127.0.0.1:5000/files?q=txt
```
–û—Ç–≤–µ—Ç:
```json
[
  {
    "id": 1,
    "name": "document",
    "extension": "pdf",
    "size": 2048,
    "path": "C:/storage/document.pdf",
    "created_at": "2026-02-19T10:30:00",
    "updated_at": "2026-02-19T10:30:00",
    "comment": "Important doc"
  }
]
```

### POST `/files`
–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –≤ –ë–î (—Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –Ω–∞ –¥–∏—Å–∫–µ).
```bash
curl -X POST http://127.0.0.1:5000/files \
  -H "Content-Type: application/json" \
  -d '{"dirpath": "C:/storage", "filename": "document.pdf"}'
```
–û—Ç–≤–µ—Ç (201 Created):
```json
{
  "id": 1,
  "name": "document",
  "extension": "pdf",
  ...
}
```

### GET `/files/{id}`
–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —Ñ–∞–π–ª–µ.
```bash
curl http://127.0.0.1:5000/files/1
```
–û—Ç–≤–µ—Ç:
```json
{
  "id": 1,
  "name": "document",
  "extension": "pdf",
  ...
}
```

### PATCH `/files/{id}`
–û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–∞ (–Ω–∞–∑–≤–∞–Ω–∏–µ, –ø—É—Ç—å, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π).
–í –∑–∞–ø—Ä–æ—Å–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –ª—é–±—ã–µ –ø–æ–ª—è, –æ–Ω–∏ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ –º–æ–¥–µ–ª—å `FileUpdate` –Ω–∞ —Å–µ—Ä–≤–∏—Å–µ.
```bash
curl -X PATCH http://127.0.0.1:5000/files/1 \
  -H "Content-Type: application/json" \
  -d '{"name": "document_v2", "comment": "Updated version"}'
```
–û—Ç–≤–µ—Ç:
```json
{
  "id": 1,
  "name": "document_v2",
  ...
}
```

### DELETE `/files/{id}`
–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª –∏–∑ –ë–î –∏ —Å –¥–∏—Å–∫–∞.
```bash
curl -X DELETE http://127.0.0.1:5000/files/1
```
–û—Ç–≤–µ—Ç:
```json
{"status": "deleted"}
```

### GET `/files/{id}/download`
–°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä.
```bash
curl -O http://127.0.0.1:5000/files/1/download
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î

–¢–∞–±–ª–∏—Ü–∞ `files` —Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ. –°—Ç–æ–ª–±—Ü—ã:

| –°—Ç–æ–ª–±–µ—Ü | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|---|---|
| `id` | SERIAL PRIMARY KEY | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä |
| `name` | VARCHAR(256) | –ò–º—è —Ñ–∞–π–ª–∞ –±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è |
| `extension` | VARCHAR(64) | –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ |
| `size` | INTEGER | –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ –±–∞–π—Ç–∞—Ö |
| `path` | VARCHAR(1024) | –ü–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –Ω–∞ –¥–∏—Å–∫–µ |
| `created_at` | TIMESTAMP | –î–∞—Ç–∞/–≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –≤ –ë–î |
| `updated_at` | TIMESTAMP | –î–∞—Ç–∞/–≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |
| `comment` | VARCHAR(1024) | –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |

## Development

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
WinterPractik/
‚îú‚îÄ‚îÄ main.py                 # Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –º–∞—Ä—à—Ä—É—Ç—ã
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ db.py               # SQLAlchemy engine –∏ session
‚îÇ   ‚îú‚îÄ‚îÄ models.py           # ORM –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ schemas.py          # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è API (FileUpdate)
‚îÇ   ‚îî‚îÄ‚îÄ manager.py          # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (FileManager)
‚îú‚îÄ‚îÄ requirements.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îî‚îÄ‚îÄ README.md               # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ FileManager

`FileManager` –≤ `backend/manager.py` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- `list_files(search=None)` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å).
- `get(file_id)` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ.
- `create_from_path(dirpath, filename)` ‚Äî –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª.
- `update(file_id, update_data)` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, –≥–¥–µ `update_data` ‚Äî dict –∏–ª–∏ `FileUpdate` –º–æ–¥–µ–ª—å. JSON —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –≤ –º–æ–¥–µ–ª—å –ø—Ä—è–º–æ –≤ —Å–µ—Ä–≤–∏—Å–µ.
- `delete(file_id, remove_file=True)` ‚Äî —É–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ –ë–î –∏ —Ñ–∞–π–ª —Å –¥–∏—Å–∫–∞.

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö SQLAlchemy.


